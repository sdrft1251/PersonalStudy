# EDA
### 1. 데이터 구성
데이터가 두개의 계층으로 구성 1)"단지코드"기준의 상위 계층, 2)단지 내의 세대 별 구분의 하위 계층.  
단지는 모두 423개의 단지로 이 계층의 데이터 개수가 적은 것으로 판단.  
[댠지 안에서 구분]  
> {'임대건물구분', '전용면적', '임대료', '임대보증금', '자격유형', '공급유형', '전용면적별세대수'}

[단지안에서 공통]  
> {'단지내주차면수', '공가수', '도보 10분거리 내 버스정류장 수', '지역', '도보 10분거리 내 지하철역 수(환승노선 수 반영)', '등록차량수', '총세대수'}

</br>

### 2. Null Check
1)임대보증금, 2)임대료, 3)지하철역 수, 4)버스정류장 수 이 4가지 데이터에 "Null"존재.  
"임대건물구분"이 "상가"인 경우, "임대보증금" 및 "임대료"가 모두 Null. 이 외에도 "아파트"인 경우에도 몇몇은 Null 값이 "-"값으로 존재.  
"지하철" 및 "버스" 값인 경우에도 Null이 존재 -> 그러나 개수가 미비해서 제거해도 될 듯하다.  
> "아파트"인 경우 데이터를 제거하는 방향으로 생각, "상가"인 경우는 해당 데이터를 제외하고 예측할 필요성이 있음

</br>

### 3. 상관 분석
1. 총세대수  
등록차량수와 강하게 상관관계가 있음. 벗어나는 경우는 대부분, "상가"인 경우
2. 전용면적  
전용면적의 경우, 직접적인 등록차량수와의 관계를 보기가 힘듬.  
"지역", "버스", "지하철" 요인들을 최대한 제거한 뒤, LGBM 모델에 적합하여 Shap 분석을 거친 결과에 의하면, "전용면적"이 클 수록 세대당 주차 등록대수가 커지는데, 영향을 주는 듯 하다.
3. 지역별  
지역 별 등록차량수의 분포 차이는 분명 존재. 그리고 추가로 제공된 지역별 인구 특성의 차이도 분명 존재. 그러나 인구특성을 예측에 그대로 활용하기에는 지역 특성과 효과가 겹쳐 이상치로 작용할 가능성이 존재.
4. 임대건물구분  
임대 건물 구분 별로는 확연한 차이가 보임. "상가"의 경우 상대적으로 세대수에 비해 적게 차량을 등록하는 것으로 보임.
5. 공급 유형  
공급유형에서도 위 전용면적과 같은 방법으로 분석했을 때, 몇몇 특성값들은, 차량 등록수를 구분하는데 어느정도 영향을 끼치는 것으로 보임. 이 특성 값들을 나누어 분석하고 예측 모델로 활용할지는 아직 미정.
6. 지하철역 수  
이 특성에 따라, 평균적인 세대별 차량 등록 수가 차이 나기는 함. 이 값을 가중치로 활용할 방법도 있고, 지표를 이용하여 변환값을 이용해 예측 모델에 넣는 방법도 있을 듯 함.
7. 버스 정류장 수  
위 지하철역 수와 거의 동일함.
8. 단지내 주차면 수  
약간의 비례 관계를 가지는 등의 결과 값을 보았을 때, 영향을 주는 듯함. 일상 생활 속에서도, 주차 가능 대수를 고려할 듯 함.
9. 자격 유형  
위 공급 유형과 거의 동일함.

</br>

# Modeling
## 1차 (파일명 : Modeling_v01)
> 상위 계층으로 값을 통합할 방법을 찾아서 적용
### Feature Engineering
1. 카테고리 변수의 각 카테고리에 대한 개수와 전체 세대수의 비율로 치환  
    a. 아파트 세대수 및 상가 세대수 비율 조정 필요 -> 여기서는 영향을 못찾겠음 -> 제거 예정
2. 나머지 연속형 변수  
    a. 전용 면적 -> 아파트 평군 면적, 상가 평균 면적.  
    b. 공가수  -> 총세대수에서 제외한 후 세대별 평균 등록차량수 구할 때 활용.  
    c. 임대료, 임대보증금 -> 아파트 평균 값, 상가 평균 값(여기서는 별의미 없는 0가 될듯)  
    d. 지하철역수, 버스정류장수 -> 그대로
3. Target 값 = 세대당 평균 차량등록 수 (등록차량수/(총세대수-공가수))
### Feature Selection
의미 있다고 보이는 변수만 추려서 사용 예정 (Shap 분석 결과 활용)
> 선택변수 : space, lent_amount, A, area, lent_fee, 영구임대, 국민임대, bus, metro

위 변수를 선택해서, lgbm에 적합
### Modeling 결과
1. MAE 기준 Train : 119 / Valid : 103 / Test : 136
2. Overfitting과 같은 현상은 안보이는 듯하다.
3. 모델 고도화 또는 Feature Engineering 필요.
### 결과 분석
원인 및 발전을 위한 결과치 분석과정
1. 총세대수 및 단지내 주차면수가 크게 차이남. -> 예측에 반영을 해야할 수도 있음. -> model_v01_02에서 살짝 테스트 시도 -> 예측상승률은 올랐으나, 주차가능면수에 크게 의지하는 경향이 나타남
2. 지역은 특정지역에서 오답이 나오기는 하나, 큰 특이점은 아님.

</br>

## 2차 (파일명 : Modeling_v02)
> 1차 모델링에서 2부류로 나누어서 예측? 1) 세대당 주차 가능횟수 2) 세대수 곱한 뒤 보정 모델 추가. 1차에서 세대수를 합쳐서 값을 유도하니, 너무 몰리는 경향이 나타나므로 이 점을 해결하기 위한 방법
### Feature Engineering
1. Target  
1번 모델 : 세대당 차량등록대수 (목표 : 최대한 세대별 특징 반영하기), 2번 모델 : 단지당 차량등록대수 (목표 : 세대수 등을 활용한 보정용 모델)
2. 세대별 구분  
2번 모델에 활용하자 구분별 세대수로 대입 (1번 모델에 넣어봤자 큰 영향력이 없음)
3. 지역  
지역별로 값 차이가 확연한게 있으므로 1번 모델에 추가
4. 공급유형  
특정 공급 유형이 큰 영향을 주는 면이 있음. 그러므로 1번 모델이 추가는 필요하나, 값을 어떻게 변형하여 넣어야할지 결정 필요. 현재의 목표는 세대의 특징을 담고 싶음 -> 1) 전체 세대에 대한 공급유형의 비율, 2) 공급유형 절대적인 수 -> 이 중 세대당 등록대수로써는 비율이 좋은 것 같음
4. 전용면적  
앞 Model version 01 에서는 평균을 이용함. 해당 단지의 대표적인 평균 면적은 나오지만 어떤 식으로 구성되는지까지는 무시가됨 -> 평균과 표준편차를 넣는다면? -> 일단 이렇게 가정하고 대입
5. 공가수  
1번 모델 Target 변수 생성 및 2번 모델에 활용
6. 자격유형  
공급유형과 동일한 방법
7. 임대보증금 & 임대료  
아파트에 해당하는 값의 평균 및 표준편차를 이용.
8. 지하철 & 버스  
둘다 1번 모델에서도 활용 2번은 고민중...
9. 단지내주차면수  
2번 보정 모델에 활용


